class: middle, center, title-slide 
<br>
# –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—ñ–Ω–≥—É

–õ–µ–∫—Ü—ñ—è 2: –í—Å—Ç—É–ø –¥–æ CUDA C

<br><br>
–ö–æ—á—É—Ä–∞ –Æ—Ä—ñ–π –ü–µ—Ç—Ä–æ–≤–∏—á<br>
[iuriy.kochura@gmail.com](mailto:iuriy.kochura@gmail.com) <br>
<a href="https://t.me/y_kochura">@y_kochura</a> <br>

???
CUDA(–∞–Ω–≥–ª. Compute Unified Device Architecture) ‚Äî –ø—Ä–æ–≥—Ä–∞–º–Ω–æ-–∞–ø–∞—Ä–∞—Ç–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î —ñ—Å—Ç–æ—Ç–Ω–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞–≤–¥—è–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ —Ñ—ñ—Ä–º–∏ Nvidia.

---

class: blue-slide, middle, center
count: false

.larger-xx[–û–≥–ª—è–¥]

---

class: middle

# –°—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ –æ–±—á–∏—Å–ª–µ–Ω—å

- –ù–∞–≤–∏—á–∫–∏ *–≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å* —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –ø—Ä–∞–∫—Ç–∏—á–Ω–æ —É—Å—ñ—Ö –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω
- *–ù–∞—É–∫–∞ –ø—Ä–æ –¥–∞–Ω—ñ* —Ç–∞ *–º–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è* —Å—Ç–∞—é—Ç—å –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –Ω–∞–≤–∏—á–∫–∞–º–∏ –≤ –±—ñ–ª—å—à–æ—Å—Ç—ñ STEM
- –ü—Ä–∞–∫—Ç–∏—á–Ω–æ –≤—Å—ñ *–ø—Ä–æ—Ü–µ—Å–æ—Ä–∏ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω—ñ*, –≤—ñ–¥ –º—ñ–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ–≤ –¥–æ —Å—É–ø–µ—Ä–∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤
- –ë—ñ–∑–Ω–µ—Å —Ç–∞ –Ω–∞—É–∫–æ–≤—ñ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–æ—Ç—Ä–µ–±—É—é—Ç—å *–®–Ü* —Ç–∞ *–ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å*


???
STEM (Science, Technology, Engineering and Mathematics, —É–∫—Ä. –Ω–∞—É–∫–∞, —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó, —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞) &sdash; —Ç–µ—Ä–º—ñ–Ω, —è–∫–∏–º –Ω–∞–∑–∏–≤–∞—é—Ç—å –ø—ñ–¥—Ö—ñ–¥ –¥–æ –æ—Å–≤—ñ—Ç–Ω—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É; –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —è–∫–æ–≥–æ –æ—Å–Ω–æ–≤–æ—é –Ω–∞–±—É—Ç—Ç—è –∑–Ω–∞–Ω—å —î –ø—Ä–æ—Å—Ç–∞ —Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–∞—É–∫–æ–≤–∏—Ö —è–≤–∏—â, —â–æ –¥–∞—î –∑–º–æ–≥—É –ª–µ–≥–∫–æ –æ—Ö–æ–ø–∏—Ç–∏ —ñ –∑–¥–æ–±—É—Ç–∏ –∑–Ω–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–∞ –≥–ª–∏–±–æ–∫–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—ñ–≤. 

–ê–∫—Ä–æ–Ω—ñ–º STEM –±—É–≤ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏–π –≤ 2001 —Ä–æ—Ü—ñ –¥–ª—è –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è —Ç—Ä–µ–Ω–¥—É –≤ –æ—Å–≤—ñ—Ç–Ω—ñ–π —Ç–∞ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—ñ–π —Å—Ñ–µ—Ä–∞—Ö –Ω–∞—É–∫–æ–≤—Ü—è–º–∏ –ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –Ω–∞—É–∫–æ–≤–æ–≥–æ —Ñ–æ–Ω–¥—É –°–®–ê. 

---


class: middle, black-slide

.center[
<video loop controls preload="auto" height="480" width="700">
  <source src="./figures/lec1/The future of computing a conversation with John Hennessy (Google I_O '18).mp4" type="video/mp4">
</video>

[The future of computing: a conversation with John Hennessy (Google I/O '18)](https://www.youtube.com/watch?v=Azt8Nc-mtKM)

]

???
John Hennessy ‚Äì –∞–º–µ—Ä–∏–∫–∞–Ω—Å—å–∫–∏–π –≤—á–µ–Ω–∏–π —É –≥–∞–ª—É–∑—ñ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ—ó —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—ó, –ø—ñ–¥–ø—Ä–∏—î–º–µ—Ü—å —Ç–∞ –ª–∞—É—Ä–µ–∞—Ç –ü—Ä–µ–º—ñ—ó –¢—é—Ä—ñ–Ω–≥–∞ (2017). –í—ñ–Ω –≤—ñ–¥–æ–º–∏–π —Å–≤–æ—ó–º –≤–Ω–µ—Å–∫–æ–º —É —Ä–æ–∑—Ä–æ–±–∫—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ RISC (Reduced Instruction Set Computing), —è–∫–∞ —Å—É—Ç—Ç—î–≤–æ –≤–ø–ª–∏–Ω—É–ª–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤.

---

class: middle
# –ü—Ä–∏—Å—Ç—Ä–æ—ó

| Device type                   | Device name          | Transistor count  | Date of introduction | Designer(s) | MOS process | Area       | Transistor density, tr./mm2 |
|-------------------------------|----------------------|-------------------|----------------------|-------------|-------------|------------|-----------------------------|
| Deep learning engine / IPU[g] | Colossus GC2         | 23,600,000,000    | 2018                 | Graphcore   | 16 nm       | ~800 mm2   | 29,500,000                  |
| Deep learning engine / IPU    | Wafer Scale Engine   | 1,200,000,000,000 | 2019                 | Cerebras    | 16 nm       | 46,225 mm2 | 25,960,000                  |
| Deep learning engine / IPU    | Wafer Scale Engine 2 | 2,600,000,000,000 | 2020                 | Cerebras    | 7 nm        | 46,225 mm2 | 56,250,000                  |
| Network switch                | NVLink4 NVSwitch     | 25,100,000,000    | 2022                 | Nvidia      | N4 (4 nm)   | 294 mm2    | 85,370,000                  |


.footnote[IPU: Intelligence Processing Unit

–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [en.wikipedia.org](https://en.wikipedia.org/wiki/Transistor_count#Parallel_systems)]

---


class: middle

.center.width-100[![](figures/lec1/Moore's_Law_Transistor_Count_1970-2020.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [en.wikipedia.org](https://en.wikipedia.org/wiki/Transistor_count#/media/File:Moore's_Law_Transistor_Count_1970-2020.png)]

---


class: middle

# –°—å–æ–≥–æ–¥–Ω—ñ

- –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å —Ç–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å —É –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∏—Ö –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö
- GPU-–ø—Ä–∏—Å–∫–æ—Ä–µ–Ω—ñ vs –ª–∏—à–µ CPU –ø—Ä–æ–≥—Ä–∞–º–∏
- –°–ø–æ—Å–æ–±–∏ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º
- –ü—Ä–∏–∫–ª–∞–¥–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å
- –ü—Ä–æ—Ü–µ—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó CUDA C/C++
- –Ø–¥—Ä–∞: —Ñ—É–Ω–∫—Ü—ñ—ó GPU
- –Ü—î—Ä–∞—Ä—Ö—ñ—è –ø–æ—Ç–æ–∫—ñ–≤
- –î–µ–º–æ

---

class: blue-slide, middle, center
count: false

.larger-xx[–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å —Ç–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å —É –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∏—Ö –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö]

---

class: middle

# –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å

.center.width-50[![](figures/lec1/portability-scalability1.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

# –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å

.center.width-50[![](figures/lec1/portability-scalability2.png)]

.alert[–¢–æ–π —Å–∞–º–∏–π –¥–æ–¥–∞—Ç–æ–∫ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é—î –Ω–∞ –Ω–æ–≤–∏—Ö –ø–æ–∫–æ–ª—ñ–Ω–Ω—è—Ö —è–¥–µ—Ä.]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

# –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å

.center.width-90[![](figures/lec1/portability-scalability3.png)]

.alert[–¢–æ–π —Å–∞–º–∏–π –¥–æ–¥–∞—Ç–æ–∫ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é—î –Ω–∞ –∫—ñ–ª—å–∫–æ—Ö –æ–¥–Ω–∞–∫–æ–≤–∏—Ö —è–¥—Ä–∞—Ö.]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

???
–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è–º–∏ –∞–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è (HW) –ø–æ–≤'—è–∑–∞–Ω–æ:
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å (—è–¥–µ—Ä)
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–æ—Ç–æ–∫—ñ–≤
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ –≤–µ–∫—Ç–æ—Ä–∞
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –ø–∞–∫–µ—Ç—É DRAM
- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–∞–Ω–∞–ª—ñ–≤ DRAM
- –ó–º–µ–Ω—à–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–æ–∫ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

---


class: middle

# –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å

.center.width-90[![](figures/lec1/portability-scalability4.png)]

.alert[–¢–æ–π —Å–∞–º–∏–π –¥–æ–¥–∞—Ç–æ–∫ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é—î –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø–∞—Ö —è–¥–µ—Ä.]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

# –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å

.center.width-90[![](figures/lec1/portability-scalability5.png)]

.alert[–¢–æ–π —Å–∞–º–∏–π –¥–æ–¥–∞—Ç–æ–∫ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é—î  –≤ —Å–∏—Å—Ç–µ–º–∞—Ö –∑ —Ä—ñ–∑–Ω–æ—é –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏.]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

???
 –ü–æ—Ç—Ä–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –∞–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è:
- –ú—ñ–∂ ISAs (Instruction Set Architectures) - X86 vs. ARM (Advanced RISC Machines) —Ç–æ—â–æ
- –ú—ñ–∂ –°PU, —è–∫—ñ –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω—ñ –Ω–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–æ–∫ —Ç–∞ –≥—Ä–∞—Ñ—ñ—á–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞–º–∏ (GPU), —è–∫—ñ –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∏—Ö –Ω–∞ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ—ó –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ
- –ú—ñ–∂  –º–æ–¥–µ–ª—è–º–∏ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º—É: VLIW (Very long instruction word ) vs. SIMD (Single instruction, multiple data) vs. –ø–æ—Ç–æ–∫—ñ–≤
- –ú—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏  –º–æ–¥–µ–ª—è–º–∏ –ø–∞–º‚Äô—è—Ç—ñ: Shared memory vs. distributed memory

---




class: blue-slide, middle, center
count: false

.larger-xx[GPU-–ø—Ä–∏—Å–∫–æ—Ä–µ–Ω—ñ                 
vs                          
–ª–∏—à–µ CPU –ø—Ä–æ–≥—Ä–∞–º–∏]

---

class: middle

.center.width-110[![](figures/lec2/g1.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g2.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g3.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g4.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g5.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g6.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g7.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g8.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.center.width-110[![](figures/lec2/g9.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---


class: middle

## –°–ø–æ—Å–æ–±–∏ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º 
<!-- .smaller-xx[
```c
#include <stdio.h> 

int main() {
  int nDevices;
```
] -->

.center[
.width-100[![](figures/lec2/app-ac.png)]
]

.center.grid[
.smaller-x.kol-1-3[
–ü—Ä–æ—Å—Ç—ñ —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ  
–í–∏—Å–æ–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å 
]
.smaller-x.kol-1-3[
–ü—Ä–æ—Å—Ç—ñ —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ  
–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∏–π –∫–æ–¥
]

.smaller-x.kol-1-3[
–í–∏—Å–æ–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å   
–í–∏—Å–æ–∫–∞ –≥–Ω—É—á–∫—ñ—Å—Ç—å 
]
]

???
–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ (–≤—ñ–¥ –∞–Ω–≥–ª. library) &mdash; —Ü–µ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å –µ–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–∞–º–∏, —á–∞—Å—Ç–æ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∫–ª—é—á–∞—Ç–∏ –¥–∞–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é, –¥–æ–≤—ñ–¥–∫–æ–≤—ñ –¥–∞–Ω—ñ, —à–∞–±–ª–æ–Ω–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–ø–∏—Å–∞–Ω–∏–π –∫–æ–¥ —ñ –ø—ñ–¥–ø—Ä–æ–≥—Ä–∞–º–∏, –∫–ª–∞—Å–∏, –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∏–ø—É.


–î–∏—Ä–µ–∫—Ç–∏–≤–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞ &mdash; —Ü–µ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å –π–æ–º—É, —è–∫ —Å–ª—ñ–¥ –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç –ø—Ä–æ–≥—Ä–∞–º–∏. –î–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ —Ü—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –Ω–∞–∑–∏–≤–∞—é—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞–º–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞, –∞–∫—Ü–µ–Ω—Ç—É—é—á–∏ —É–≤–∞–≥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —Ç–æ–º—É, —â–æ —Ü—ñ –¥–∏—Ä–µ–∫—Ç–∏–≤–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å –æ–±—Ä–æ–±–∫—É –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –ø—Ä–æ–≥—Ä–∞–º–∏, –ø–µ—Ä—à –Ω—ñ–∂ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–æ—á–Ω–µ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –∞—Å–µ–º–±–ª–µ—Ä–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –ø—Ä–æ–≥—Ä–∞–º–∏. –î–∏—Ä–µ–∫—Ç–∏–≤–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è —Å–∏–º–≤–æ–ª–æ–º #.

---

class: blue-slide, middle, center
count: false

.larger-xx[–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏]

---

class: middle

## –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏: –ø—Ä–æ—Å—Ç–∞, –≤–∏—Å–æ–∫–æ-—è–∫—ñ—Å–Ω–µ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è 

- .bold[*–ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:*] –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–∞ GPU –±–µ–∑ –ø–æ–≥–ª–∏–±–ª–µ–Ω–∏—Ö –∑–Ω–∞–Ω—å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è GPU 
- –ë–∞–≥–∞—Ç–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫ –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–∞ GPU –¥–æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö API, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏ –∫–æ–¥—É
- .bold[*–Ø–∫—ñ—Å—Ç—å:*] –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –≤–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è —É –≤–µ–ª–∏–∫—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤ 


---

class:  middle

# –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ 

.center[
.width-100[![](figures/lec2/Math-Libraries.png)]
]


<!--   <div class="divmomentum">
      <iframe class="iframemomentum" src="https://developer.nvidia.com/gpu-accelerated-libraries/" scrolling="no" frameborder="no" style="position:absolute; top:-260px; left: -140px; width:1220px; height: 668px"></iframe>
  </div> -->


.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [GPU-Accelerated Libraries](https://developer.nvidia.com/gpu-accelerated-libraries), NVIDIA]

???
–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–∞ –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö –∑–∞–∫–ª–∞–¥–∞—é—Ç—å –æ—Å–Ω–æ–≤—É –¥–ª—è —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å —É —Ç–∞–∫–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö, —è–∫ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞ –¥–∏–Ω–∞–º—ñ–∫–∞, –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ –≥—ñ–¥—Ä–æ–¥–∏–Ω–∞–º—ñ–∫–∞, –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ —Ö—ñ–º—ñ—è, –º–µ–¥–∏—á–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ —Å–µ–π—Å–º–æ—Ä–æ–∑–≤—ñ–¥–∫–∞. 

---

class:  middle

## –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
<br>
.center[
.width-40[![](figures/lec2/Thrust.png)]

Thrust

–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ —ñ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–∏—Ö C++ –∑ GPU 
]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [GPU-Accelerated Libraries](https://developer.nvidia.com/gpu-accelerated-libraries), NVIDIA]

???
Thrust &mdash; –ø–æ—Ç—É–∂–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ —ñ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–∏—Ö. –í–∏–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—ñ–¥ —á–∞—Å –≤–∏–≤—á–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–∑–≤‚Äô—è–∑–∫—ñ–≤ —É –ø—Ä–∏—Ä–æ–¥–Ω–∏—á–∏—Ö –Ω–∞—É–∫–∞—Ö, –ª–æ–≥—ñ—Å—Ç–∏—Ü—ñ, –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—ñ –ø–æ–¥–æ—Ä–æ–∂–µ–π —Ç–æ—â–æ.

Thrust –∑–∞–±–µ–∑–ø–µ—á—É—î –≥–Ω—É—á–∫–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∏—Å–æ–∫–æ–≥–æ —Ä—ñ–≤–Ω—è –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –Ω–∞ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ, —â–æ –∑–Ω–∞—á–Ω–æ –ø—ñ–¥–≤–∏—â—É—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Thrust, —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∏ C++ –º–æ–∂—É—Ç—å –Ω–∞–ø–∏—Å–∞—Ç–∏ –ª–∏—à–µ –∫—ñ–ª—å–∫–∞ —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –∑ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–∏–º –≥—Ä–∞—Ñ—ñ—á–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ—Ä–æ–º –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ —à–≤–∏–¥—à–µ, –Ω—ñ–∂ —Å—É—á–∞—Å–Ω—ñ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω—ñ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∏ (CPU). –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∞–ª–≥–æ—Ä–∏—Ç–º **thrust::sort** –∑–∞–±–µ–∑–ø–µ—á—É—î –≤—ñ–¥ 5 –¥–æ 100 —Ä–∞–∑—ñ–≤ —à–≤–∏–¥—à—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, –Ω—ñ–∂ STL (Standard Template Library) —Ç–∞ TBB (Intel Threading Building Blocks).

Intel Threading Building Blocks (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∞ —è–∫ TBB) - –∫—Ä–æ—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–≤–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ —à–∞–±–ª–æ–Ω—ñ–≤ C++, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –∫–æ–º–ø–∞–Ω—ñ—î—é Intel –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è.  

---

class:  middle

## –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –≤—ñ–∑—É–∞–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ 
<br>

.center[
.width-100[![](figures/lec2/Image-Video-Libraries.png)]
]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [GPU-Accelerated Libraries](https://developer.nvidia.com/gpu-accelerated-libraries), NVIDIA]

???
–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –∑ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–∏–º –≥—Ä–∞—Ñ—ñ—á–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ—Ä–æ–º –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è, –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å —ñ –≤—ñ–¥–µ–æ, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å CUDA —ñ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –∞–ø–∞—Ä–∞—Ç–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤. 

---

class:  middle

## –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó
<br>

.center[
.width-60[![](figures/lec2/Communication-Libraries.png)]
]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [GPU-Accelerated Libraries](https://developer.nvidia.com/gpu-accelerated-libraries), NVIDIA]

???
–û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω—ñ –ø—Ä–∏–º—ñ—Ç–∏–≤–∏ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ —Ç–∞ –±–∞–≥–∞—Ç—å–æ—Ö –≤—É–∑–ª—ñ–≤. 

---

class:  middle

## –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –≥–ª–∏–±–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è
<br>

.center[
.width-100[![](figures/lec2/Deep-Learning-Libraries.png)]
]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [GPU-Accelerated Libraries](https://developer.nvidia.com/gpu-accelerated-libraries), NVIDIA]

???
–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–∞ –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö –¥–ª—è –≥–ª–∏–±–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å CUDA —Ç–∞ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –∞–ø–∞—Ä–∞—Ç–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤.

---

class: blue-slide, middle, center
count: false

.larger-xx[–î–∏—Ä–µ–∫—Ç–∏–≤–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞]

---

class:  middle

## –î–∏—Ä–µ–∫—Ç–∏–≤–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞: –ø—Ä–æ—Å—Ç–∞, –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–µ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è
<br>

- .bold[*–ü—Ä–æ—Å—Ç–æ—Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:*] –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–æ–¥–±–∞—î –ø—Ä–æ –¥–µ—Ç–∞–ª—ñ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º–æ–º —ñ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è–º –¥–∞–Ω–∏—Ö 
- .bold[*–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å:*] –ö–æ–¥ —î –∑–∞–≥–∞–ª—å–Ω–∏–º, –Ω–µ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–º –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ —Ç–∏–ø—É –∞–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–∞ –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π –Ω–∞ –∫—ñ–ª—å–∫–æ—Ö –º–æ–≤–∞—Ö
- .bold[*–ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å:*] –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ–¥—É –º–æ–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞ 

---


class:  middle

# OpenACC

- –î–∏—Ä–µ–∫—Ç–∏–≤–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞ –¥–ª—è –°/C++ —Ç–∞ Fortran

.bold[–ü—Ä–∏–∫–ª–∞–¥:]

```c
main()
{
    <serial code>
    #pragma acc kernels
    // automatically runs on GPU
    {
        <parallel code>
    } 
}
```
.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [OpenACC Directives](https://developer.nvidia.com/openacc/overview), NVIDIA]


???
OpenACC (Open Accelerators) &mdash; –ø—Ä–æ–≥—Ä–∞–º–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —â–æ —Ä–æ–∑—Ä–æ–±–ª—è—î—Ç—å—Å—è y Cray, CAPS, Nvidia —ñ PGI. –°—Ç–∞–Ω–¥–∞—Ä—Ç –æ–ø–∏—Å—É—î –Ω–∞–±—ñ—Ä –¥–∏—Ä–µ–∫—Ç–∏–≤ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∏—Ö –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º, —â–æ –∑–∞–¥—ñ—é—é—Ç—å —è–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π, —Ç–∞–∫ —ñ –≥—Ä–∞—Ñ—ñ—á–Ω–∏–π –ø—Ä–æ—Ü–µ—Å–æ—Ä. 

–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –ø—ñ–¥–∂–∏–≤–ª—é—é—Ç—å –æ–¥–Ω—ñ –∑ –Ω–∞–π–±—ñ–ª—å—à –∑–∞—Ö–æ–ø–ª—é—é—á–∏—Ö –Ω–∞—É–∫–æ–≤–∏—Ö –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ–≤ —Å—å–æ–≥–æ–¥–Ω—ñ. –î–ª—è –≤—á–µ–Ω–∏—Ö —ñ –¥–æ—Å–ª—ñ–¥–Ω–∏–∫—ñ–≤, —è–∫—ñ –ø—Ä–∞–≥–Ω—É—Ç—å —à–≤–∏–¥—à–æ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤, OpenACC –∑–∞–±–µ–∑–ø–µ—á—É—î –ø—Ä–æ—Å—Ç–∏–π, –∞–ª–µ –ø–æ—Ç—É–∂–Ω–∏–π –ø—ñ–¥—Ö–æ–¥ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ–≤ –±–µ–∑ –¥–æ–∫–ª–∞–¥–∞–Ω–Ω—è –∑–Ω–∞—á–Ω–∏—Ö –∑—É—Å–∏–ª—å –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (–Ω–µ–∑–Ω–∞—á–Ω—ñ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–¥—É).  

---

class: blue-slide, middle, center
count: false

.larger-xx[–ú–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è]

---

class:  middle

## –ú–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è: –≤–∏—Å–æ–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞ –≥–Ω—É—á–∫–µ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è
<br>

- .bold[*–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:*] –ü—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç –º–æ–∂–µ –Ω–∞–π–∫—Ä–∞—â–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö 
- .bold[*–ì–Ω—É—á–∫—ñ—Å—Ç—å:*] –û–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –¥–æ –æ–±–º–µ–∂–µ–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É –±—ñ–±–ª—ñ–æ—Ç–µ—á–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤ –∞–±–æ —Ç–∏–ø—ñ–≤ –¥–∏—Ä–µ–∫—Ç–∏–≤
- .bold[*–ë–∞–≥–∞—Ç–æ—Å–ª—ñ–≤–Ω—ñ—Å—Ç—å:*] –ü—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç—É —á–∞—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏—Ä–∞–∑–∏—Ç–∏ –±—ñ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π 
---

class:  middle

# –ú–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è GPU
<br>

.center[
.width-100[![](figures/lec2/languages.png)]
]

---

class: middle

.center[
.width-90[![](figures/lec2/gpu-computing-applications.png)]
]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [CUDA C++ Programming Guide](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#fnsrc_1), NVIDIA]

???
CUDA &mdash; –∞–±—Ä–µ–≤—ñ–∞—Ç—É—Ä–∞ Compute Unified Device Architecture (–û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏—Å—Ç—Ä–æ—é).

–£ –ª–∏—Å—Ç–æ–ø–∞–¥—ñ 2006 —Ä–æ–∫—É NVIDIA –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ CUDA, –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (general purpose parallel computing platform and programming model), —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–µ—Ö–∞–Ω—ñ–∑–º –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å —É –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö NVIDIA –¥–ª—è –≤–∏—Ä—ñ—à–µ–Ω–Ω—è –±–∞–≥–∞—Ç—å–æ—Ö —Å–∫–ª–∞–¥–Ω–∏—Ö –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º, –Ω—ñ–∂ –Ω–∞ CPU.

CUDA –ø–æ—Å—Ç–∞—á–∞—î—Ç—å—Å—è –∑ –ø—Ä–æ–≥—Ä–∞–º–Ω–∏–º —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ C++ —è–∫ –º–æ–≤—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤–∏—Å–æ–∫–æ–≥–æ —Ä—ñ–≤–Ω—è. –Ø–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Ü—å–æ–º—É —Å–ª–∞–π–¥—ñ, CUDA –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ç–∞–∫–æ–∂ —ñ–Ω—à—ñ –º–æ–≤–∏, —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –∞–±–æ –ø—ñ–¥—Ö–æ–¥–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∏—Ä–µ–∫—Ç–∏–≤, —Ç–∞–∫—ñ —è–∫ FORTRAN, DirectCompute, OpenACC. 

–ü–æ—è–≤–∞ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ —ñ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ –æ–∑–Ω–∞—á–∞—î, —â–æ —á—ñ–ø–∏ –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ —Ç–µ–ø–µ—Ä —î –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏. –ó–∞–≤–¥–∞–Ω–Ω—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —è–∫–µ –ø—Ä–æ–∑–æ—Ä–æ –º–∞—Å—à—Ç–∞–±—É—î —Å–≤–æ—é –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ—Å—Ç—å. –ú–æ–¥–µ–ª—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è CUDA —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –¥–ª—è –ø–æ–¥–æ–ª–∞–Ω–Ω—è —Ü—ñ—î—ó –ø—Ä–æ–±–ª–µ–º–∏.

–£ –π–æ–≥–æ –æ—Å–Ω–æ–≤—ñ —Ç—Ä–∏ –∫–ª—é—á–æ–≤—ñ –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—ó: —ñ—î—Ä–∞—Ä—Ö—ñ—è –≥—Ä—É–ø –ø–æ—Ç–æ–∫—ñ–≤, —Å–ø—ñ–ª—å–Ω–∞ –ø–∞–º‚Äô—è—Ç—å (shared memories) —ñ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –±–∞—Ä‚Äô—î—Ä—ñ–≤ (barrier synchronization), —è–∫—ñ –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–∞—é—Ç—å—Å—è –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç—É —è–∫ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –º–æ–≤–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å.

---

class: blue-slide, middle, center
count: false

.larger-xx[–ü—Ä–∏–∫–ª–∞–¥–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å]

---

class: middle

## –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è RGB –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É –≤—ñ–¥—Ç—ñ–Ω–∫–∏ —Å—ñ—Ä–æ–≥–æ
.center[
.width-100[![](figures/lec2/parallel-example.png)]
]

$$\boxed{O = r \cdot 0.21 + g \cdot 0.72 + b \cdot 0.07}$$

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [Applied Parallel Programming](https://wiki.illinois.edu/wiki/download/attachments/740033143/ece408-lecture2-CUDA-introduction-sjp-FL21.pdf?version=1&modificationDate=1629984366000&), David Kirk and Wen-mei W. Hwu]

???
–î–ª—è —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ–π –∫–ª—é—á–æ–≤–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü—ñ–π –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏—Ö –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞ –º–æ–≤–∞, —è–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –º–∞—Å–∏–≤–Ω–∏–π –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º —ñ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è &mdash; CUDA C. CUDA C —Ä–æ–∑—à–∏—Ä—é—î –ø–æ–ø—É–ª—è—Ä–Ω—É –º–æ–≤—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è C –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º –Ω–æ–≤–∏–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏, —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç–∞–º —Å–∫–æ–Ω—Ü–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏—Å—å –Ω–∞ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∏—Ö –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —è–∫ —è–¥—Ä–∞ CPU, —Ç–∞–∫ —ñ –º–∞—Å–∏–≤–Ω–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –≥—Ä–∞—Ñ—ñ—á–Ω—ñ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∏ (GPUs). –Ø–∫ –≤–∏–ø–ª–∏–≤–∞—î –∑ –Ω–∞–∑–≤–∏, CUDA C –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ CUDA NVIDIA. CUDA —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —ñ–Ω–¥—É—Å—Ç—Ä—ñ—ó –≤–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, —É –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç–∞–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∏, –Ω–∞–ª–∞–≥–æ–¥–∂—É–≤–∞—á—ñ (debuggers) —Ç–∞ –ø—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è (Profiling - —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å CUDA).

Visual Profiler &mdash; —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è, —è–∫–∏–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —á–∞—Å–æ–≤—É —à–∫–∞–ª—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ CPU —Ç–∞ GPU –≤–∞—à–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏, –∞ —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –∞–Ω–∞–ª—ñ–∑—É –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.


–ö–æ–ª–∏ —Å—É—á–∞—Å–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –ø—Ä–∞—Ü—é—é—Ç—å –ø–æ–≤—ñ–ª—å–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–∑–≤–∏—á–∞–π –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –ø–æ–¥–∞–Ω–æ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –¥–∞–Ω–∏—Ö –¥–ª—è –æ–±—Ä–æ–±–∫–∏. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –º–∞–Ω—ñ–ø—É–ª—é—é—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º–∏ –∞–±–æ –≤—ñ–¥–µ–æ –≤—ñ–¥ –º—ñ–ª—å–π–æ–Ω—ñ–≤ –¥–æ —Ç—Ä–∏–ª—å–π–æ–Ω—ñ–≤ –ø—ñ–∫—Å–µ–ª—ñ–≤. –ù–∞—É–∫–æ–≤—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –º–æ–¥–µ–ª—é—é—Ç—å –≥—ñ–¥—Ä–æ–¥–∏–Ω–∞–º—ñ–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å—ñ—Ç–∫–∏ –Ω–∞ –º—ñ–ª—å—è—Ä–¥–∏ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –≤—É–∑–ª—ñ–≤. –î–æ–¥–∞—Ç–∫–∏ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ—ó –¥–∏–Ω–∞–º—ñ–∫–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ —Ç–∏—Å—è—á–∞–º–∏ –π –º—ñ–ª—å–π–æ–Ω–∞–º–∏ –∞—Ç–æ–º—ñ–≤. –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –∞–≤—ñ–∞–∫–æ–º–ø–∞–Ω—ñ–π —Å—Ç–æ—Å—É—î—Ç—å—Å—è —Ç–∏—Å—è—á —Ä–µ–π—Å—ñ–≤, –µ–∫—ñ–ø–∞–∂—ñ–≤ —ñ –≤–∏—Ö–æ–¥—ñ–≤ –¥–æ –∞–µ—Ä–æ–ø–æ—Ä—Ç—É. –í–∞–∂–ª–∏–≤–æ, —â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å —ñ–∑ —Ü–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤, —á–∞—Å—Ç–∏–Ω–æ–∫, –≤—É–∑–ª—ñ–≤ —Å—ñ—Ç–æ–∫, –≤–∑–∞—î–º–æ–¥—ñ–π, –ø–æ–ª—å–æ—Ç—ñ–≤ —Ç–æ—â–æ –º–æ–∂–Ω–∞ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –Ω–µ–∑–∞–ª–µ–∂–Ω–æ. 

–î–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ª—å–æ—Ä–æ–≤–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è –≤ –≥—Ä–∞–¥–∞—Ü—ñ—é —Å—ñ—Ä–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ª–∏—à–µ –¥–∞–Ω—ñ —Ü—å–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è. –ü—ñ–∫—Å–µ–ª—ñ –º–æ–∂–Ω–∞ –æ–±—á–∏—Å–ª—é–≤–∞—Ç–∏ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –æ–¥–∏–Ω –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ –ø—ñ–¥ —á–∞—Å —Ç–∞–∫–æ–≥–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è. 

---

class: middle

# –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤–µ–∫—Ç–æ—Ä—ñ–≤
.center[
.width-100[![](figures/lec2/vecAdd.png)]
]

---



class: middle

## –ü—Ä–æ—Ü–µ—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó CUDA C/C++

- –¢–∏–ø–æ–≤–∏–π –∫–æ–¥ CUDA C/C++: *—Ö–æ—Å—Ç (CPU) + –ø—Ä–∏—Å—Ç—Ä—ñ–π (GPU)*

.center.width-70[![](figures/lec2/compilation-process.png)]
    

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: Programming Massively Parallel Processors, David Kirk and Wen-mei W. Hwu]

???
–¢–µ–ø–µ—Ä –º–∏ –≥–æ—Ç–æ–≤—ñ –¥–æ —Ç–æ–≥–æ, —â–æ–± –ø–æ—á–∞—Ç–∏ –≤—á–∏—Ç–∏—Å—è –ø–∏—Å–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ –∑ CUDA C/C++, —è–∫—ñ –± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º –¥–∞–Ω–∏—Ö –¥–ª—è —à–≤–∏–¥—à–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–∏ CUDA C –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å–ø—ñ–≤—ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ö–æ—Å—Ç–∞-host (CPU) —ñ –æ–¥–Ω–æ–≥–æ –∞–±–æ –∫—ñ–ª—å–∫–æ—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤-devices (GPU) –≤ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ. 

–ö–æ–∂–µ–Ω –≤–∏—Ö—ñ–¥–Ω–∏–π —Ñ–∞–π–ª CUDA –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—é –∫–æ–¥—É —Ö–æ—Å—Ç–∞ —Ç–∞ –ø—Ä–∏—Å—Ç—Ä–æ—é. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±—É–¥—å-—è–∫–∞ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ C/C++ —î –ø—Ä–æ–≥—Ä–∞–º–æ—é CUDA, —è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –∫–æ–¥ —Ö–æ—Å—Ç–∞. –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∏—Å—Ç—Ä–æ—é —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –±—É–¥—å-—è–∫–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π —Ñ–∞–π–ª. –§—É–Ω–∫—Ü—ñ—ó –∞–±–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–ª—è –ø—Ä–∏—Å—Ç—Ä–æ—é —á—ñ—Ç–∫–æ –ø–æ–∑–Ω–∞—á–µ–Ω—ñ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–º–∏ –∫–ª—é—á–æ–≤–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ CUDA C. –¶–µ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –≤–µ–ª–∏–∫–∏–π –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º –¥–∞–Ω–∏—Ö –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º. 

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∏—Å—Ç—Ä–æ—é —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –¥–æ–¥–∞–Ω—ñ –¥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É, –≤–æ–Ω–∏ –±—ñ–ª—å—à–µ –Ω–µ –ø—Ä–∏–π–Ω—è—Ç–Ω—ñ –¥–ª—è —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–≥–æ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞ C. –ö–æ–¥ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–æ–º, —è–∫–∏–π —Ä–æ–∑–ø—ñ–∑–Ω–∞—î —Ç–∞ —Ä–æ–∑—É–º—ñ—î —Ü—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è. –ú–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø—ñ–¥ –Ω–∞–∑–≤–æ—é NVCC (NVIDIA C Compiler). 

–Ø–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Ä–∏—Å—É–Ω–∫—É, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä NVCC –æ–±—Ä–æ–±–ª—è—î –ø—Ä–æ–≥—Ä–∞–º—É CUDA C, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ CUDA, —â–æ–± —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –∫–æ–¥ —Ö–æ—Å—Ç–∞ —Ç–∞ –∫–æ–¥ –ø—Ä–∏—Å—Ç—Ä–æ—é. –ö–æ–¥ —Ö–æ—Å—Ç–∞ &mdash; —Ü–µ –ø—Ä—è–º–∏–π –∫–æ–¥ C ANSI, —è–∫–∏–π –¥–æ–¥–∞—Ç–∫–æ–≤–æ –∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—ñ–≤ C/C++ —Ö–æ—Å—Ç–∞ —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —è–∫ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏–π –ø—Ä–æ—Ü–µ—Å CPU. –ö–æ–¥ –ø—Ä–∏—Å—Ç—Ä–æ—é –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π –∫–ª—é—á–æ–≤–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ CUDA –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –¥–∞–Ω–∏—Ö, —è–∫—ñ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è —è–¥—Ä–∞–º–∏, —ñ –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –Ω–∏–º–∏ –¥–æ–ø–æ–º—ñ–∂–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ —ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö. –ö–æ–¥ –ø—Ä–∏—Å—Ç—Ä–æ—é –¥–∞–ª—ñ –∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º NVCC —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó GPU. –£ —Å–∏—Ç—É–∞—Ü—ñ—è—Ö, –∫–æ–ª–∏ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∞–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é –∞–±–æ —è–∫—â–æ —è–¥—Ä–æ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—è –Ω–∞ CPU, —Ç–æ–¥—ñ –º–æ–∂–Ω–∞ –≤–∏–±—Ä–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ —è–¥—Ä–∞ –Ω–∞ CPU –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É, —è–∫ MCUDA. 

---

class: middle

## CUDA/OpenCL &mdash; –º–æ–¥–µ–ª—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è 

- –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –∞–±–æ –ø–æ–º—ñ—Ä–Ω–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ –≤ –∫–æ–¥—ñ, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è **—Ö–æ—Å—Ç–æ–º** 
- –í–∏—Å–æ–∫–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ –≤ –∫–æ–¥—ñ, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è **–ø—Ä–∏—Å—Ç—Ä–æ—î–º**: —è–¥—Ä–æ 

.width-100[![](figures/lec2/dh.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [Applied Parallel Programming](https://wiki.illinois.edu/wiki/download/attachments/740033143/ece408-lecture2-CUDA-introduction-sjp-FL21.pdf?version=1&modificationDate=1629984366000&), David Kirk and Wen-mei W. Hwu]

???
OpenCL (Open Computing Language) &mdash; —Ü–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω–æ—Ä—ñ–¥–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, —â–æ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ (CPU), –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ (GPU), —Ü–∏—Ñ—Ä–æ–≤–∏—Ö —Å–∏–≥–Ω–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ (DSP), –ø—Ä–æ–≥—Ä–∞–º–æ–≤–∞–Ω–∏—Ö –ª–æ–≥—ñ—á–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü—å (FPGA) —Ç–∞ —ñ–Ω—à–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä—ñ–≤ –∞–±–æ –∞–ø–∞—Ä–∞—Ç–Ω–∏—Ö –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ–≤. 

–í–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏ CUDA –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Ü—å–æ–º—É —Ä–∏—Å—É–Ω–∫—É. –í–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –∫–æ–¥—É —Ö–æ—Å—Ç–∞ (CPU serial code). –ö–æ–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—è —è–¥—Ä–∞ (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –∫–æ–¥ –ø—Ä–∏—Å—Ç—Ä–æ—é) –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–±–æ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, –≤–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –≤–µ–ª–∏–∫–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø–æ—Ç–æ–∫—ñ–≤ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó. –£—Å—ñ –ø–æ—Ç–æ–∫–∏, —è–∫—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∑–∞–ø—É—Å–∫–æ–º —è–¥—Ä–∞, —Å–ø—ñ–ª—å–Ω–æ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è —Å—ñ—Ç–∫–æ—é (grid).

–¶—ñ –ø–æ—Ç–æ–∫–∏ —î –æ—Å–Ω–æ–≤–Ω–∏–º –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ CUDA. –ù–∞ —Ü—å–æ–º—É —Ä–∏—Å—É–Ω–∫—É –ø–æ–∫–∞–∑–∞–Ω–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–≤–æ—Ö —Å—ñ—Ç–æ–∫ –ø–æ—Ç–æ–∫—ñ–≤. –ù–µ–∑–∞–±–∞—Ä–æ–º –º–∏ –æ–±–≥–æ–≤–æ—Ä–∏–º–æ, —è–∫ —Ü—ñ —Å—ñ—Ç–∫–∏ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω—ñ. –ö–æ–ª–∏ –≤—Å—ñ –ø–æ—Ç–æ–∫–∏ —è–¥—Ä–∞ –∑–∞–≤–µ—Ä—à—É—é—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∞ —Å—ñ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è, –¥–∞–ª—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è –Ω–∞ —Ö–æ—Å—Ç—ñ, –¥–æ–∫–∏ –Ω–µ –±—É–¥–µ –∑–∞–ø—É—â–µ–Ω–æ —ñ–Ω—à–µ —è–¥—Ä–æ. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç—É—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ —Å–ø—Ä–æ—â–µ–Ω–∞ –º–æ–¥–µ–ª—å, –¥–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ CPU —ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞ GPU –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞—é—Ç—å—Å—è. –ë–∞–≥–∞—Ç–æ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–∏—Ö –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º —Ñ–∞–∫—Ç–∏—á–Ω–æ –∫–µ—Ä—É—é—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º CPU —Ç–∞ GPU, —â–æ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞—é—Ç—å—Å—è, —â–æ–± —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –ø–µ—Ä–µ–≤–∞–≥–∞–º–∏ —è–∫ CPU, —Ç–∞–∫ —ñ GPU. 

---

class: middle

# –Ø–¥—Ä–∞ (Kernels)

- –Ø–¥—Ä–æ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ ``` __global__```

```C

// Kernel definition
__global__ void VecAdd(float* A, float* B, float* C)
{
int i = threadIdx.x;
C[i] = A[i] + B[i];
}
int main()
{
...
// Kernel invocation with N threads
VecAdd<<<1, N>>>(A, B, C);
...
}
```
.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: [Programming Model](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#programming-model), CUDA Toolkit v11.6.0]

???
CUDA C/C++ —Ä–æ–∑—à–∏—Ä—é—î C/C++, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç—É –≤–∏–∑–Ω–∞—á–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó (—è–¥—Ä–∞), —è–∫—ñ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è N —Ä–∞–∑—ñ–≤ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ N —Ä—ñ–∑–Ω–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ CUDA, –Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –∑–≤–∏—á–∞–π–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑. 

–Ø–¥—Ä–æ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü—ñ—ó __global__, –∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤ CUDA, —è–∫—ñ –±—É–¥—É—Ç—å –≤–∏–∫–æ–Ω–∞–Ω—ñ —Ü–∏–º —è–¥—Ä–æ–º, –≤–∫–∞–∑—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–æ–≤–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω–∞–Ω–Ω—è <<<...>>>.  –ö–æ–∂–Ω–æ–º—É –ø–æ—Ç–æ–∫—É, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î —è–¥—Ä–æ, –Ω–∞–¥–∞—î—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫—É, –¥–æ—Å—Ç—É–ø–Ω–∏–π —É —è–¥—Ä—ñ —á–µ—Ä–µ–∑ –≤–±—É–¥–æ–≤–∞–Ω—ñ –∑–º—ñ–Ω–Ω—ñ. 

–¢—É—Ç –∫–æ–∂–µ–Ω –∑ N –ø–æ—Ç–æ–∫—ñ–≤, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å VecAdd(), –≤–∏–∫–æ–Ω—É—î –æ–¥–Ω–µ –ø–æ–ø–∞—Ä–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è. 

---


class: middle

# –Ü—î—Ä–∞—Ä—Ö—ñ—è –ø–æ—Ç–æ–∫—ñ–≤

.width-95[![](figures/lec2/threds.png)]

---

class: middle

# $\texttt{gridDim}$ 

–ö—ñ–ª—å–∫—ñ—Å—Ç—å –±–ª–æ–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –≤–∏–º—ñ—Ä—ñ:
- $\texttt{gridDim.x} = 8$
- $\texttt{gridDim.y} = 3$ 
- $\texttt{gridDim.z} = 2$   

.center.width-70[![](figures/lec2/grid.png)]

---

class: middle

# $\texttt{blockIdx}$ 

–ö–æ–∂–µ–Ω –±–ª–æ–∫ –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å —É —Å—ñ—Ç—Ü—ñ:
- $\texttt{blockIdx.x} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{gridDim.x} -1$)
- $\texttt{blockIdx.y} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{gridDim.y} -1$)
- $\texttt{blockIdx.z} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{gridDim.z} -1$)

.center.width-70[![](figures/lec2/grid.png)]

---

class: middle

# $\texttt{blockDim}$ 

–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤ —É –±–ª–æ—Ü—ñ:
- $\texttt{blockDim.x} = 4$  
- $\texttt{blockDim.y} = 4$  
- $\texttt{blockDim.z} = 4$  

.center.width-100[![](figures/lec2/thread.png)]

---


class: middle

# $\texttt{threadIdx}$ 

–ö–æ–∂–µ–Ω –ø–æ—Ç—ñ–∫ –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å —É –±–ª–æ—Ü—ñ:
- $\texttt{threadIdx.x} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{blockDim.x} -1$)
- $\texttt{threadIdx.y} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{blockDim.x} -1$)
- $\texttt{threadIdx.z} \;\;$  (–≤—ñ–¥ $0$ –¥–æ $\texttt{blockDim.x} -1$)

.center.width-100[![](figures/lec2/thread.png)]

???

–ö–æ–∂–µ–Ω threadIdx —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É —É —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É. threadIdx —Ç–∞ blockIdx —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É —É —Ä–∞–º–∫–∞—Ö —Å—ñ—Ç–∫–∏.

---

class: blue-slide, middle, center
count: false

.larger-xx[–ü—Ä–∏–∫–ª–∞–¥: –æ–¥–Ω–æ–≤–∏–º—ñ—Ä–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫]

---

class: middle

.center.width-110[![](figures/lec2/0.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[–î–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —è–¥—Ä–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ *–∫—ñ–ª—ñ–∫—ñ—Å—Ç—å –±–ª–æ–∫—ñ–≤* —Ç–∞ *–∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤* –≤ –æ–¥–Ω–æ–º—É –±–ª–æ—Ü—ñ]

.center.width-90[![](figures/lec2/1.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{gridDim.x}$ –≤–∏–∑–Ω–∞—á–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–ª–æ–∫—ñ–≤ —É —Å—ñ—Ç—Ü—ñ, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{gridDim.x} = 2$]

.center.width-90[![](figures/lec2/2.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{blockIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Ç–æ—á–Ω–∏–π —ñ–Ω–¥–µ–∫—Å –±–ª–æ–∫—É —É —Å—ñ—Ç—Ü—ñ, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{blockIdx.x} = 0$]

.center.width-90[![](figures/lec2/3.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{blockIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Ç–æ—á–Ω–∏–π —ñ–Ω–¥–µ–∫—Å –±–ª–æ–∫—É —É —Å—ñ—Ç—Ü—ñ, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{blockIdx.x} = 1$]

.center.width-90[![](figures/lec2/4.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{blockDim.x}$ –≤–∏–∑–Ω–∞—á–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤ —É –±–ª–æ—Ü—ñ, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{blockDim.x} = 4$]

.center.width-90[![](figures/lec2/5.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[–£—Å—ñ –±–ª–æ–∫–∏ —É —Å—ñ—Ç—Ü—ñ –º—ñ—Å—Ç—è—Ç—å **–æ–¥–Ω–∞–∫–æ–≤—É** –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤]

.center.width-90[![](figures/lec2/6.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 0$]

.center.width-90[![](figures/lec2/7.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 1$]

.center.width-90[![](figures/lec2/8.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---


class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 2$]

.center.width-90[![](figures/lec2/9.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 3$]

.center.width-90[![](figures/lec2/10.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 0$]

.center.width-90[![](figures/lec2/11.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 1$]

.center.width-90[![](figures/lec2/12.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 2$]

.center.width-90[![](figures/lec2/13.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---

class: middle

.smaller-x[$\texttt{threadIdx.x}$ –≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å –ø–æ—Ç–æ–∫—É —É –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É $\texttt{threadIdx.x} = 3$]

.center.width-90[![](figures/lec2/14.png)]

.footnote[–î–∂–µ—Ä–µ–ª–æ —Å–ª–∞–π–¥—É: NVIDIA, DLI]

---


class: blue-slide, middle, center
count: false

.larger-xx[–î–µ–º–æ: –∑–∞–ø–∏—Ç –ø—Ä–∏—Å—Ç—Ä–æ—é]

<a href="https://colab.research.google.com/github/YKochura/ac-kpi/blob/main/tutor/lec2/DeviceQuery.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

---

class: blue-slide, middle, center
count: false

.larger-xx[–î–µ–º–æ: –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤–µ–∫—Ç–æ—Ä—ñ–≤]

<a href="https://colab.research.google.com/github/YKochura/ac-kpi/blob/main/tutor/lec2/vectAdd.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

---


# –î–æ–¥–∞—Ç–æ–∫


- NVIDIA, [CUDA Quick Start Guide](https://docs.nvidia.com/cuda/cuda-quick-start-guide/index.html)

---


class: end-slide, center
count: false

.larger-xx[–ö—ñ–Ω–µ—Ü—å üèÅ]